<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" 
	integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
	 integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

	<!-- Add the datatables library CSS -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">

<!-- Add the jQuery library -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Add the datatables library JS -->
<script type="text/javascript" src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>

<!-- Add the column filtering plugin JS -->
<script type="text/javascript" src="https://cdn.rawgit.com/rewonc/jquery.dataTables.columnFilter/v1.5.6/dist/jquery.dataTables.columnFilter.js"></script>


	<title>Community</title>

	<style>
/* html{
    zoom: 80%;
} */
body {
        height: 45rem;
        width: 93.75rem;
        background: rgb(0, 206, 161);
    }
#heading {
      margin-top: 5px;
      display: flex;
      justify-content: center;
		
		}
    #heading h1{
      font-size: xx-large; 
      font-style:italic; 
      font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode',Verdana, sans-serif;
      background-color: white;
      box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.5);
      border-radius: 1.56em;
      width: 21.25em;      
      text-align: center;
    }
    #navbar{
      background-color: rgb(0, 74, 132);
      height: 6.2%;
      /* margin: 40px; */
      width: 100%;
      display: flex;
      justify-content: end;
      margin-left: 1.2%;
      margin-right: 1.2%;
      margin-top: 1.2%;
      /* margin-left: 1.09375em;
      margin-right: 1.09375em; */
    }
    #parentele {
    display: flex;
    /* justify-content: center; */
    border: 4px solid lightgrey;
    height: 85%;
    margin-left: 1.2%;
    margin-right: 1.2%;
    /* margin-top: 1px; */
    background-color: white;
    width: 100%
}

.left-nav {
  position: absolute;
  float: left;
  margin: 0.8em;
  width: 15em;
  font-size:small;
  color: black;
  box-shadow: inset 2px 2px 4px rgb(0, 206, 161);
  height: 32em;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  justify-content:space-around;
  align-items: center;
  border-radius: 0.5em;
}
#mainele {
    border: 1px solid black;
    height: 95%;
    width: 85%;
    margin-left: 14.5%;
    background-color: whitesmoke;
    
    /* right: 0; */
    /* margin-left: 20px; */
    /* margin-right: 10px; */
    bottom: 0;
    overflow-x: scroll;
    white-space: nowrap;
    }



		/* Styling for the headings in side navbars */
		.left-nav h2
		 {
			margin: 0;
			padding: 10px 0;
			text-align: center;
		}

		/* Styling for the links in side navbars */
		.left-nav ul
		{
			list-style: none;
			margin: 0;
			padding: 0;
			display: flex;
			flex-direction: column;
			align-items: center;
			width: 100%;
		}

		.left-nav li
		 {
			width: 100%;
			margin: 10px 0;
		}

		.left-nav a {
			color: black;
			text-decoration: none;
			width: 100%;
			display: block;
			padding: 10px;
			box-sizing: border-box;
			text-align: center;
			border-radius: 5px;
			transition: background-color 0.3s ease;
		}

		.left-nav a:hover
 {
			background-color: #555;
		}
		    /* Set table width to 100% */
			table {
      width: 100%;
    }

    /* Add some spacing between table cells */
    td, th {
      padding: 8px;
    }

    /* Add some borders to table cells */
    td {
      border: 1px solid #ddd;
    }

    /* Add a gray background color to the header row */
    thead tr {
      background-color: #f1f1f1;
    }

    /* Add a hover effect to table rows */
    tbody tr:hover {
      background-color: #f5f5f5;
    }

    /* Customize pagination buttons */
    .paginate_button {
      background-color: #e7e7e7;
      border: 1px solid #ddd;
      color: black;
      padding: 8px 16px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
    }

    .paginate_button:hover {
      background-color: #ddd;
    }

    .paginate_button.current {
      background-color: #4CAF50;
      color: white;
    }

    /* Customize column filter inputs */
    .dataTables_filter input {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-bottom: 10px;
    }

    .dataTables_filter input:focus {
      outline: none;
      box-shadow: 0 0 3px #ddd;
    }
	.card {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  width: 300px;
  height: 400px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
  transition: transform 0.2s ease-in-out;
}

.card:hover {
  transform: scale(1.05);
}

.card img {
  width: 100%;
  height: 60%;
  object-fit: cover;
  border-top-left-radius: 10px;
  border-top-right-radius: 10px;
}

.card h2 {
  margin: 20px;
  font-size: 20px;
  font-weight: bold;
}

.card p {
  margin: 0 20px 20px;
  font-size: 16px;
  text-align: justify;
}

/* Mobile Styles */

/* @media only screen and (max-width: 600px) {
  .card {
    width: 90%;
    height: auto;
  }

  .card img {
    height: 50%;
  }

  .card h2 {
    font-size: 18px;
  }

  .card p {
    font-size: 14px;
  } */
/* } */
/* Style the table */
table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
}

/* Style the table headers */
th {
  background-color: #f2f2f2;
  text-align: left;
  padding: 8px;
  font-size: 16px;
}

/* Style the table rows */
tr:nth-child(even) {
  background-color: #f2f2f2;
}

tr:hover {
  background-color: #ddd;
}

/* Style the table cells */
td {
  border: 1px solid #ddd;
  padding: 8px;
}
.box {
  background-color: #f4f0f0;
  border: 1px solid #ddd;
  border-radius: 5px;
  padding: 10px;
  box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
  transition: box-shadow 0.3s ease;
  width:400px;
}

.box:hover {
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
}

.box h2 {
  margin: 0;
}
.box2 {
  background-color: #f4f0f0;
  border: 1px solid #ddd;
  border-radius: 5px;
  padding: 10px;
  box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
  transition: box-shadow 0.3s ease;
  width:800px;
  margin-left: 450px;
}


/* Add media queries for responsive design */
/* @media only screen and (max-width: 600px) {
  table, th, td {
    display: block;
    width: 100%;
  }
  th, td {
    text-align: center;
  }
} */
.loader {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  border: 4px solid rgba(0, 0, 0, 0.1);
  border-top-color: #3498db;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}
#datatable tbody td:first-child {
  position: sticky;
  left: 0;
  z-index: 1;
  background-color: white;
}


.fixedheader:first-of-type {
  position: sticky;
  left: 0;
  /* your styles here */
}
.fixedheader{
  background-color: rgb(0, 74, 132);
  color: white;
}



	</style>
</head>
<body>
	<!-- Header -->
	<header >
		<div id="heading">
			<h1 >COMMUNITY VIEW</h1>
		  </div>
	</header>

	<div id="navbar">
    <!-- <nav style="margin-left: 70rem;" class="top-nav "> -->
      <button style="background-color:white; height: 34px;">
        <a href="/constituency">
         PrevView
        </a>
      </button> 
      <button style="background-color:white; height: 34px;">
        <a href="/trendysrcp">
         NextView
        </a>
      </button> 
			<button style="background-color:white; height: 34px;">
				<a href="/homepage" title="HomePage">
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-door-fill" viewBox="0 0 16 16">
						<path d="M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5Z"/>
					  </svg>
					</a>
			</button >
      <button title="Logout" style="background-color:white; height: 34px;">
        <a href="/logout">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-right" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z"/>
            <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
          </svg>
        </a>
      </button>
	<!-- </nav> -->
  </div>
	<div id="parentele">
		<div class="left-nav">
		  <nav >
			<header>
			  <h4>SELECTION</h4>
			</header>
            <form id="form" method="get" action="/districtAndParliaments">
                <ul>
                  <li><input type="radio" name="selectedOption" value='District'>DISTRICTS</li>
                  <li><input type="radio" name="selectedOption" value="PARLIAMENT">PARLIAMENT</li>
                  <span>See % Of</span>
                  <li><input type="radio" name="selectedParty" value="TDP">TDP</li>
                  <li><input type="radio" name="selectedParty" value="JSP">JSP</li>
                  <li><input type="radio" name="selectedParty" value="YSRCP">YSRCP</li>
                </ul>
                <button type="submit" name="submit" class="btn btn-dark">Submit</button>
              </form>
            </nav>
          </div>
          <div id="mainele">
          </div>
    </div>
<script>


// Attach an event listener to the submit button
document.querySelector('#form').addEventListener('submit', async (event) => {
  event.preventDefault();
   // Show the loader
  // Add a loader to the page
  const selectedOption = document.querySelector('input[name="selectedOption"]:checked');
  const selectedParty = document.querySelector('input[name="selectedParty"]:checked');
  

  if (!selectedOption || !selectedParty) {
    alert("Please select an option.");
    return;
  }
  const loader = document.createElement("div");
  loader.classList.add("loader");
  loader.style.position = "fixed";
  loader.style.top = "40%";
  loader.style.left = "50%";
  loader.style.transform = "translate(-50%, -50%)";
  loader.style.border = "25px solid rgba(0, 0, 0, 0.1)";
  loader.style.borderTopColor = "#3498db";
  loader.style.borderRadius = "75%";
  loader.style.width = "250px";
  loader.style.height = "250px";
  loader.style.animation = "spin 1s ease-in-out infinite";
  const text = document.createElement("span");
text.textContent = "Loading data";
text.style.position = "absolute";
text.style.top = "50%";
text.style.left = "50%";
text.style.transform = "translate(-50%, -50%)";
text.style.fontSize = "20px";
text.style.fontWeight = "bold";
loader.appendChild(text);

  document.body.appendChild(loader);

 

  try {
    const { data } = await axios.get(`/districtAndParliaments?selectedOption=${selectedOption.value}&selectedParty=${selectedParty.value}`);
    if (data && data.length > 0) {
      const tableHeaders = Object.keys(data[0]).map((header, index) => `
        <th class='fixedheader'>
          ${header}
          ${index === 0 ? `
            <select class="filter-dropdown">
              <option value=""> ${header}</option>
              ${Array.from(new Set(data.map(row => row[header]))).map(value => `
                <option value="${value}">${value}</option>
              `).join("")}
            </select>` : ''}
        </th>
      `).join("");

      const tableRows = data.map(row => `
        <tr>
          ${Object.values(row).map(value => `<td>${value}</td>`).join("")}
        </tr>
      `).join("");

      const mainele = document.getElementById("mainele");
      mainele.innerHTML = `
        <table id="datatable">
          <thead>
            <tr>
              ${tableHeaders}
            </tr>
          </thead>
          <tbody>
            ${tableRows}
          </tbody>
        </table>
      `;

      // Initialize DataTable plugin with pagination and column filtering options
      $(document).ready(function() {
      const table = $('#datatable').DataTable({
        "paging": false,
        scrollY: '400px',
        scrollX: true,
        scrollCollapse: true,
        ordering: false,
        searching: true,
        columnDefs: [
          { targets: '_all', searchable: true },
          { targets: '_all', sortable: false }
        ]
      });

      $('.search-input').on('keyup', function() {
        const columnIdx = $(this).parent().index();
        const searchValue = $(this).val();
        table.column(columnIdx).search(searchValue).draw();
      });

      $('.filter-dropdown').on('change', function() {
        const columnIdx = $(this).parent().index();
        const filterValue = $(this).val();
        table.column(columnIdx).search(filterValue).draw();
      });
    });
    } else {
      console.error('No data found');
    }
  } catch (error) {
    console.error(error);
  }
  finally {
    // Remove the loader from the page
    document.body.removeChild(loader);
  }
});



</script>
	  
	
</body>
</html>